name: Deploy
on: [workflow_dispatch]
jobs:
    build:
        # Use the Build workflow described above
        uses: ./.github/workflows/build.yml
    deploy:
        needs: [build]
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v3
            - name: Download artifact
              uses: actions/download-artifact@v3
              with:
                  # This is the name of the "Upload artifact" action above.
                  name: build-result
            - name: Run Conveyor
              uses: hydraulic-software/conveyor/actions/build@v12.0
              with:
                  extra_flags: '-f ./gui/conveyor.conf'
                  command: make copied-site
                  signing_key: ${{ secrets.SIGNING_KEY }}
                  agree_to_license: 1
